<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.4.0 -->
    <script>window.materialVersion = "1.4.0"</script>

    <!-- Title -->
    
    <title>
        
            RemoteView 使用详解与实现原理 | 
        
        Albert&#39;s Blog
    </title>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    
    
    
    
    
    
    
    
    
    

    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="Albert Humbert">
    <meta name="description" itemprop="description" content="-">
    <meta name="keywords" content="null,notes">

    <!-- Site Verification -->
    
    

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!--iOS -->
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Albert&#39;s Blog">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://alberthumbert.github.io">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="RemoteView 使用详解与实现原理 | Albert&#39;s Blog">
    <meta property="og:image" content="/img/favicon.png" />
    <meta property="og:description" content="-">
    <meta property="og:article:tag" content="notes"> 

    
        <meta property="article:published_time" content="9月 11, 2017" />
        <meta property="article:modified_time" content="11月 21, 2017" />
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:title" content="RemoteView 使用详解与实现原理 | Albert&#39;s Blog">
    <meta name="twitter:description" content="-">
    <meta name="twitter:image" content="/img/favicon.png">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://alberthumbert.github.io" />

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="https://alberthumbert.github.io/2017/09/11/RemoteView/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Albert&#39;s Blog",
        "logo": "/img/favicon.png"
    },
    "author": {
        "@type": "Person",
        "name": "Albert Humbert",
        "image": {
            "@type": "ImageObject",
            "url": "/img/favicon.png"
        },
        "description": "Paranoid Android"
    },
    "headline": "RemoteView 使用详解与实现原理",
    "url": "https://alberthumbert.github.io/2017/09/11/RemoteView/index.html",
    "datePublished": "9月 11, 2017",
    "dateModified": "11月 21, 2017",
    "description": "-",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://alberthumbert.github.io"
    }
}
</script>


    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(key){try{localStorage.removeItem(key)}catch(e){}};lsloader.setLS=function(key,val){try{localStorage.setItem(key,val)}catch(e){}};lsloader.getLS=function(key){var val="";try{val=localStorage.getItem(key)}catch(e){val=""}return val};versionString="/*"+materialVersion+"*/";lsloader.clean=function(){try{var keys=[];for(var i=0;i<localStorage.length;i++){keys.push(localStorage.key(i))}keys.forEach(function(key){var data=lsloader.getLS(key);if(data&&data.indexOf(versionString)===-1){lsloader.removeLS(key)}})}catch(e){}};lsloader.clean();lsloader.load=function(jsname,jspath,cssonload){cssonload=cssonload||function(){};var code;code=this.getLS(jsname);if(code&&code.indexOf(versionString)===-1){this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload);return}if(code){var versionNumber=code.split(versionString)[0];if(versionNumber!=jspath){console.log("reload:"+jspath);this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload);return}code=code.split(versionString)[1];if(/\.js?.+$/.test(versionNumber)){this.jsRunSequence.push({name:jsname,code:code});this.runjs(jspath,jsname,code)}else{document.getElementById(jsname).appendChild(document.createTextNode(code));cssonload()}}else{this.requestResource(jsname,jspath,cssonload)}};lsloader.requestResource=function(name,path,cssonload){var that=this;if(/\.js?.+$/.test(path)){this.iojs(path,name,function(path,name,code){that.setLS(name,path+versionString+code);that.runjs(path,name,code)})}else if(/\.css?.+$/.test(path)){this.iocss(path,name,function(code){document.getElementById(name).appendChild(document.createTextNode(code));that.setLS(name,path+versionString+code)},cssonload)}};lsloader.iojs=function(path,jsname,callback){var that=this;that.jsRunSequence.push({name:jsname,code:""});try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(path,jsname,xhr.response);return}}that.jsfallback(path,jsname)}};xhr.send(null)}catch(e){that.jsfallback(path,jsname)}};lsloader.iocss=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.iofonts=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.runjs=function(path,name,code){if(!!name&&!!code){for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code=code}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var script=document.createElement("script");script.appendChild(document.createTextNode(this.jsRunSequence[0].code));script.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(script);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var that=this;var script=document.createElement("script");script.src=this.jsRunSequence[0].path;script.type="text/javascript";this.jsRunSequence[0].status="loading";script.onload=function(){that.jsRunSequence.shift();if(that.jsRunSequence.length>0){that.runjs()}};document.body.appendChild(script)}};lsloader.tagLoad=function(path,name){this.jsRunSequence.push({name:name,code:"",path:path,status:"failed"});this.runjs()};lsloader.jsfallback=function(path,name){if(!!this.jsnamemap[name]){return}else{this.jsnamemap[name]=name}for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code="";this.jsRunSequence[k].status="failed";this.jsRunSequence[k].path=path}}this.runjs()};lsloader.cssfallback=function(path,name,cssonload){if(!!this.cssnamemap[name]){return}else{this.cssnamemap[name]=1}var link=document.createElement("link");link.type="text/css";link.href=path;link.rel="stylesheet";link.onload=link.onerror=cssonload;var root=document.getElementsByTagName("script")[0];root.parentNode.insertBefore(link,root)};lsloader.runInlineScript=function(scriptId,codeId){var code=document.getElementById(codeId).innerText;this.jsRunSequence.push({name:scriptId,code:code});this.runjs()};lsloader.loadCombo=function(jslist){var updateList="";var requestingModules={};for(var k in jslist){var LS=this.getLS(jslist[k].name);if(!!LS){var version=LS.split(versionString)[0];var code=LS.split(versionString)[1]}else{var version=""}if(version==jslist[k].path){this.jsRunSequence.push({name:jslist[k].name,code:code,path:jslist[k].path})}else{this.jsRunSequence.push({name:jslist[k].name,code:null,path:jslist[k].path,status:"comboloading"});requestingModules[jslist[k].name]=true;updateList+=(updateList==""?"":";")+jslist[k].path}}var that=this;if(!!updateList){var xhr=new XMLHttpRequest;xhr.open("get",combo+updateList,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){that.runCombo(xhr.response,requestingModules);return}}else{for(var i in that.jsRunSequence){if(requestingModules[that.jsRunSequence[i].name]){that.jsRunSequence[i].status="failed"}}that.runjs()}}};xhr.send(null)}this.runjs()};lsloader.runCombo=function(comboCode,requestingModules){comboCode=comboCode.split("/*combojs*/");comboCode.shift();for(var k in this.jsRunSequence){if(!!requestingModules[this.jsRunSequence[k].name]&&!!comboCode[0]){this.jsRunSequence[k].status="comboJS";this.jsRunSequence[k].code=comboCode[0];this.setLS(this.jsRunSequence[k].name,this.jsRunSequence[k].path+versionString+comboCode[0]);comboCode.shift()}}this.runjs()}})();</script>

    <!-- Import CSS & jQuery -->
    
        <style id="css/material.min.css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("css/material.min.css","/css/material.min.css?fJTiM/K1J3dWIruo3pxtAw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";})</script>
        <style id="css/style.min.css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("css/style.min.css","/css/style.min.css?oCSEO3ST+aEypEwttTDI9g==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";})</script>
        
        
            <style>
    
    .footer-sns-facebook {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiPjxwYXRoIGQ9Ik0xMzguNiA3OGMtMjIuNCA1LjItNTUuOCA0MC4yLTYwLjYgNjMuNC0xLjQgNi40LTIgMTI5LjgtMS42IDM2Ny42LjYgMjk4LjYgMSAzNTguOCAzLjQgMzYzIDExIDIwLjIgMjEuNiAzMi40IDM3LjIgNDMgMTUgMTAuMiAxNy40IDExLjIgMzMgMTMgMTEuMiAxLjQgMTM2IDIgMzY1IDEuNiAzMTQtLjYgMzQ4LjYtMSAzNTUtMy44IDE1LjgtNy4yIDMzLjgtMjIgNDMuMi0zNS40IDUuMi03LjQgMTAuOC0xNi42IDEyLjYtMjAuNCAyLjgtNi40IDMuMi00MC44IDMuOC0zNTQgLjQtMjIzLS4yLTM1My40LTEuNC0zNjUtMi0xNy0yLjYtMTguNi0xMy0zNC04LjYtMTIuNi0xNC4yLTE4LjQtMjUuMi0yNS44LTcuOC01LjQtMTcuNC0xMS0yMS42LTEyLjQtNi0yLjItNzIuOC0yLjYtMzY1LjQtMi42LTE5Ni44LjItMzYxIC44LTM2NC40IDEuOHptNjU3LjYgODcuOGw0LjggMy44djU1LjJjMCA1NC42IDAgNTUuMi00LjYgNTkuNi00LjQgNC40LTYgNC42LTUwLjIgNS42bC00NS42IDEtNy4yIDUuNmMtMTAuNCA4LTE2LjggMTcuMi0xOS4yIDI3LjQtMSA1LTEuOCAyNC44LTEuOCA0NCAuMiAzOCAxLjYgNDQuNiAxMC44IDQ4IDIuOCAxLjIgMjguNCAyIDU2LjggMiA0Ny44IDAgNTIgLjIgNTYuMiAzLjhsNC44IDMuOHY1NS4yYzAgNTQuNiAwIDU1LjItNC42IDU5LjYtNC40IDQuNi01LjQgNC42LTU3IDUuMi0yOC44LjItNTQuNC44LTU2LjggMS40LTIuNC42LTUuNiAzLTYuOCA1LjQtMS44IDMuMi0yLjQgNDEuNC0yLjYgMTQzLjJsLS4yIDEzOC44LTUuNiA0LjgtNS42IDQuOEg2MDljLTUyLjQgMC01Mi44IDAtNTguMi00LjZsLTUuNC00LjYtLjItMTQwLjYtLjItMTQwLjYtNC44LTMuOGMtNC4yLTMuNC04LTMuOC0zNS42LTMuOC0zMi44IDAtNDEtMS44LTQzLjYtMTAtLjYtMi4yLTEuMi0yNS40LTEuMi01MS40IDAtNjAuOC0uMi01NyAzLjQtNjEuNiAyLjgtMy42IDYtNCAzNy44LTUgMzMtMSAzNS4yLTEuMiAzOS40LTUuNiA0LjYtNC40IDQuNi01LjIgNS44LTcxIDEuMi03My40LjItNjcuMiAxNi42LTk5LjQgOC0xNS44IDEyLjgtMjIgMjgtMzcgMTUuMi0xNS4yIDIxLjQtMTkuNiAzOC4yLTI4IDExLTUuNCAyNC0xMSAyOS0xMi4yIDYuMi0xLjggMjguNi0yLjYgNzEuMi0yLjYgNTguNi0uMiA2Mi42IDAgNjcgMy42eiIvPjwvc3ZnPg==);
    }
    
    
    .footer-sns-twitter {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiPjxwYXRoIGQ9Ik0xMzguNiA3OGMtMjIuNCA1LjItNTUuOCA0MC4yLTYwLjYgNjMuNC0xLjQgNi40LTIgMTI5LjgtMS42IDM2Ny42LjYgMjk4LjYgMSAzNTguOCAzLjQgMzYzIDExIDIwLjIgMjEuNiAzMi40IDM3LjIgNDMgMTUgMTAuMiAxNy40IDExLjIgMzMgMTMgMTEuMiAxLjQgMTM2IDIgMzY1IDEuNiAzMTQtLjYgMzQ4LjYtMSAzNTUtMy44IDE1LjgtNy4yIDMzLjgtMjIgNDMuMi0zNS40IDUuMi03LjQgMTAuOC0xNi42IDEyLjYtMjAuNCAyLjgtNi40IDMuMi00MC44IDMuOC0zNTQgLjQtMjIzLS4yLTM1My40LTEuNC0zNjUtMi0xNy0yLjYtMTguNi0xMy0zNC04LjYtMTIuNi0xNC4yLTE4LjQtMjUuMi0yNS44LTcuOC01LjQtMTcuNC0xMS0yMS42LTEyLjQtNi0yLjItNzIuOC0yLjYtMzY1LjQtMi42LTE5Ni44LjItMzYxIC44LTM2NC40IDEuOHptNTMyLjggMjA1YzEwIDQgMjMgMTAuOCAyOC44IDE1LjIgMTIuNiA5LjIgMTYuNiAxMC42IDI5LjQgOS40IDYuNi0uNiAxMy0zLjIgMjAuNC04LjIgMTEuMi03LjYgMTkuNC05LjIgMjMuNi01IDMuNiAzLjYgMi44IDktMi44IDE4LjYtNy4yIDEyLjQtNiAxOC44IDQuMiAyNC4yIDQuNCAyLjIgOC4yIDUuNiA4LjYgNy40IDEgNC44LTEyLjYgMjQuMi0yMiAzMS44LTExLjggOS4yLTE3LjIgMjIuNi0xOS42IDQ3LjgtNC44IDUwLjQtNy44IDY2LjYtMTYuNCA4NS40LTMgNy03IDE3LjgtOC44IDI0LTEuOCA2LjQtNSAxNC42LTcuNCAxOC40LTIuMiAzLjgtNy40IDEzLTExLjQgMjAuNC0xNy4yIDMwLjgtNDMuNCA2MS40LTcxLjQgODMuOC0yNS42IDIwLjQtNDYgMzMuMi02NC4yIDQwLjItOC40IDMuMi0xOCA3LjYtMjEuNCA5LjYtNy40IDQuNi0yMi40IDguNi01Ny4yIDE1LTYyLjIgMTEuNi03OS4yIDExLjQtMTM1LjYtMS0zMi40LTctMzguNi05LTUyLTE2LjgtMjEuNC0xMi42LTI0LjItMTQuOC0yNC4yLTE5LjQgMC02LjIgMTAuMi05LjIgMzUtMTAuNCAyMi40LTEgMjguNi0yLjYgNTctMTQuMiAyMy44LTkuOCAyOS40LTEyLjggMzAuNC0xNi44IDIuMi04LjItMy0xMy4yLTI2LjgtMjUuNC0yNS44LTEzLjItMzIuMi0xOC40LTQzLjgtMzUuOC05LTEzLjYtMTAtMjEuMi0zLjYtMzMuNiA1LjQtMTAuOCAzLjYtMTUtMTEuOC0yNS40LTktNi0xNC0xMS42LTIwLjgtMjIuNi0yMy40LTM3LjgtMjUtNTAuOC03LjItNTkuOCA0LjgtMi40IDkuNC01LjQgMTAuMi02LjYgMi44LTQuMi0uNC0xNS42LTguNC0yOS0xMS42LTE5LjYtMTMuMi0yNS44LTEzLjItNTUuMiAwLTI4LjggMi42LTM3LjggMTItNDAuMiA5LTIuMiAxNC44IDEgMzUuNiAyMC4yIDI0LjggMjIuOCA0My42IDM2LjYgNjIuOCA0NS44IDggMy44IDE3LjggOS4yIDIyIDEyIDQuMiAyLjggMTQuOCA3IDIzLjQgOS4yIDguNiAyLjIgMjQuMiA2LjggMzQuOCAxMC4yIDEzLjQgNC40IDIzLjYgNi40IDMzIDYuNiAxMi44LjIgMTQuMi0uMiAxOC42LTUuNCA0LTQuOCA0LjgtNy44IDQuOC0xOS4yIDAtMTQuNCA1LjYtMzkuNiAxMS4yLTUwLjYgNC4yLTguNCAyOS4yLTM0LjIgMzkuOC00MS40IDcuOC01LjQgMzUuNi0xNiA1Mi0yMCAxNC4yLTMuNiAzMi42LTEuMiA1Mi40IDYuOHoiLz48L3N2Zz4=);
    }
    
    
    .footer-sns-gplus {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiPjxwYXRoIGQ9Ik0xMzguNiA3OGMtMjIuNCA1LjItNTUuOCA0MC4yLTYwLjYgNjMuNC0xLjQgNi40LTIgMTI5LjgtMS42IDM2Ny42LjYgMjk4LjYgMSAzNTguOCAzLjQgMzYzIDExIDIwLjIgMjEuNiAzMi40IDM3LjIgNDMgMTUgMTAuMiAxNy40IDExLjIgMzMgMTMgMTEuMiAxLjQgMTM2IDIgMzY1IDEuNiAzMTQtLjYgMzQ4LjYtMSAzNTUtMy44IDE1LjgtNy4yIDMzLjgtMjIgNDMuMi0zNS40IDUuMi03LjQgMTAuOC0xNi42IDEyLjYtMjAuNCAyLjgtNi40IDMuMi00MC44IDMuOC0zNTQgLjQtMjIzLS4yLTM1My40LTEuNC0zNjUtMi0xNy0yLjYtMTguNi0xMy0zNC04LjYtMTIuNi0xNC4yLTE4LjQtMjUuMi0yNS44LTcuOC01LjQtMTcuNC0xMS0yMS42LTEyLjQtNi0yLjItNzIuOC0yLjYtMzY1LjQtMi42LTE5Ni44LjItMzYxIC44LTM2NC40IDEuOHpNNDMwIDI5NS40YzQwLjYgMTUuNCA1Ni42IDIzLjggNzIuNiAzOC40IDYuOCA2LjIgNy4yIDE1LjIgMSAyMy40LTYuMiA4LTMzLjYgMzMuOC0zOSAzNi42LTUuNiAyLjgtMTcuNiAyLjgtMjMuMi0uMi0yLjQtMS4yLTguMi01LjItMTMtOC44LTExLjItOC42LTI0LjYtMTEuMi01NS4yLTExLjItMjcuNCAwLTQwLjYgMi42LTUyLjIgMTAuNC00LjQgMi44LTEyLjIgNy42LTE3LjIgMTAuNi0yMyAxMy4yLTUxLjQgNTUtNTUuOCA4Mi40LTIuNiAxNS42LTIuNCAzNC44LjIgNTEgMi44IDE3LjQgMTkuOCA0OC44IDM1LjIgNjUuMiAxNiAxNi42IDQ1IDMzLjYgNjIuOCAzNi42IDI2LjggNC40IDY1LjggMS42IDc5LjQtNS44IDIwLjYtMTEuNCAzMS0xOSA0MS0zMC40IDE4LjgtMjEuNiAyMy40LTM0LjIgMTUuNi00My44LTMuOC00LjgtNC40LTQuOC01MS01LjgtNjAuOC0xLjItNTYuMiAyLjItNTYuMi00My4yIDAtMzIuNC4yLTMzLjIgNC44LTM3IDQuNC0zLjYgOS0zLjggOTItMy44IDc5IDAgODcuOC40IDk0LjIgMy42IDExLjIgNS42IDEzIDExLjQgMTIuOCA0My40IDAgMjUuNC0uOCAzMC44LTcuNiA1OC00IDE2LjYtOS44IDM0LTEyLjYgMzktMi44IDUtOC4yIDE0LjItMTEuNiAyMC42LTguNCAxNS40LTI3LjIgMzYuOC00MC44IDQ2LjYtNS44IDQuNC0xMy44IDEwLjItMTcuNiAxMy4yLTMuOCAzLTExIDctMTYuMiA4LjgtNS4yIDEuOC0xNi4yIDYuNC0yNC40IDEwLTIyLjQgOS42LTM0LjggMTEuNi03MyAxMS42LTM3LjYuMi00Ny0xLjQtNzEtMTItOC4yLTMuNi0xNy42LTcuMi0yMC44LTgtMTUuOC0zLjgtNjctNDUuMi03Ny44LTYyLjgtMi4yLTMuOC03LjYtMTEuNi0xMS44LTE3LjItNC4yLTUuNC05LTE0LTEwLjYtMTktMS44LTQuOC02LjItMTYtMTAtMjQuOC0zLjYtOC44LTcuOC0yMi4yLTkuMi0yOS42LTMuMi0xOC44LTEuNC03OS40IDIuOC05MS40IDEzLjgtNDAuNiAzNS42LTc4IDU4LjgtMTAwLjIgMTQtMTMuNiA0Ny4yLTM2LjQgNTgtMzkuOCA0LjItMS40IDEzLjQtNS4yIDIwLjYtOC40IDIyLTEwIDMyLjgtMTEuNiA3Ni0xMSAzMy44LjYgNDAuNCAxLjIgNTAgNC44em0zNDAuOCA4MC44YzggMy42IDkuNiAxMS4yIDkuMiAzOS4yLS42IDM0LjQtLjYgMzQgNSAzOS42IDQuOCA1IDUuNCA1IDM3LjYgNSA0My40IDAgNDQuNC44IDQzLjIgMzYuMi0uOCAxNy0xLjIgMTguNC02LjQgMjMtNS40IDQuNi02LjYgNC44LTM3LjYgNC44LTMxLjIgMC0zMiAuMi0zNi44IDUtNS42IDUuNC01LjYgNC40LTUgNDEuMi40IDI2LjQuMiAyNy40LTQuNiAzMy00LjggNS42LTYgNS44LTI0LjQgNi40LTIwLjguOC0yOS42LTEuNC0zMy40LTguNC0xLjQtMi42LTItMTUuNi0xLjgtMzUuNi40LTMxLjIuNC0zMS42LTQuNi0zNi42cy01LjYtNS0zNi01Yy0xOC44IDAtMzMtLjgtMzYtMi4yLTcuNi0zLjYtOS42LTExLjItOC44LTMzLjguOC0yOC4yLjQtMjggNDEtMjggNDUuNCAwIDQ1LjQgMCA0NC42LTQyLjYtLjYtMzMtLjYtMzMgNS0zOC40IDQuNC00LjYgNi4yLTUgMjQuOC01IDExIDAgMjIuMiAxIDI1IDIuMnoiLz48L3N2Zz4=);
    }
    
    
    
    
    
    
    
    
    
</style>

        
        <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"rel="stylesheet">


        <script>lsloader.load("js/jquery.min.js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==")</script>
    
    
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Analytics -->
    

    <!-- Custom Head -->
    
</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    
    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#RemoteView-详解"><span class="post-toc-number">1.</span> <span class="post-toc-text">RemoteView 详解</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#AppWidget"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">AppWidget</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#AppWidgetProviderInfo"><span class="post-toc-number">1.1.1.</span> <span class="post-toc-text">AppWidgetProviderInfo</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#主布局"><span class="post-toc-number">1.1.2.</span> <span class="post-toc-text">主布局</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#AppWidgetProvider"><span class="post-toc-number">1.1.3.</span> <span class="post-toc-text">AppWidgetProvider</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#RemoteViewService-amp-amp-RemoteViewsFactory"><span class="post-toc-number">1.1.4.</span> <span class="post-toc-text">RemoteViewService && RemoteViewsFactory</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#RemoteViews"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">RemoteViews</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#AppWidget-与-binder"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">AppWidget 与 binder</span></a></li></ol></li></ol>
        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>
    





<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                RemoteView 使用详解与实现原理
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Albert Humbert</strong>
        <span>9月 11, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/notes/">notes</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=RemoteView 使用详解与实现原理&url=https://alberthumbert.github.io/2017/09/11/RemoteView/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=RemoteView 使用详解与实现原理&url=https://alberthumbert.github.io/2017/09/11/RemoteView/index.html&via=Albert Humbert" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://alberthumbert.github.io/2017/09/11/RemoteView/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=https://alberthumbert.github.io/2017/09/11/RemoteView/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    
        <a class="post_share-link" href="https://www.linkedin.com/shareArticle?mini=true&url=https://alberthumbert.github.io/2017/09/11/RemoteView/index.html&title=RemoteView 使用详解与实现原理" target="_blank">
            <li class="mdl-menu__item">
                分享到 LinkedIn
            </li>
        </a>
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=Albert&#39;s Blog&title=RemoteView 使用详解与实现原理&summary=developing&pics=https://alberthumbert.github.io/img/favicon.png&url=https://alberthumbert.github.io/2017/09/11/RemoteView/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
        <a class="post_share-link" href="https://telegram.me/share/url?url=https://alberthumbert.github.io/2017/09/11/RemoteView/index.html&text=RemoteView 使用详解与实现原理" target="_blank">
            <li class="mdl-menu__item">
                分享到 Telegram
            </li>
        </a>
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p>-</p>
<a id="more"></a>
<h2 id="RemoteView-详解"><a href="#RemoteView-详解" class="headerlink" title="RemoteView 详解"></a>RemoteView 详解</h2><ul>
<li>RemoteView，是一种用于跨进程显示View的工具，使用场景一般为显示通知和实现桌面控件</li>
<li>相对于Binder，RemoteView效率更高但限制也更多</li>
<li>下面以桌面控件 AppWidget 为例，讲解RemoteView的使用</li>
</ul>
<h3 id="AppWidget"><a href="#AppWidget" class="headerlink" title="AppWidget"></a>AppWidget</h3><ul>
<li>AppWidget 虽然是一种可选的界面，但是它能够十分方便地为用户提供信息，更重要的是它为整个应用提供了快捷的入口，网上关于AppWidget的文章虽然多但是写得都不是很清晰，忽略了一些需要注意的坑，希望这篇文章能够提供更全面的讲解，写AppWidget主要分为以下几个步骤</li>
</ul>
<pre><code>1.使用XML文件为控件提供元数据（AppWidgetProviderInfo）
2.使用XML文件为控件提供布局信息
3.实现AppWidgetProvider管理控件的生命周期和提供数据
4.使用Service更新界面（可选）
5.实现RemoteViewsService和RemoteViewsFactory为控件提供更复杂的布局及其点击事件的响应（可选）
6.在manifest文件中注册AppWidgetProvider和用到的service 
</code></pre><ul>
<li>我们首先来观察manifest文件，下面是一个简单的例子，从这个例子我们可以知道 AppWidgetProvider 虽然名字比较有误导性，但它其实是一个BroadcastReceiver，标签中的meta-data就是刚刚说的AppWidgetProviderInfo，intent-filter中必须要有android.appwidget.action.APPWIDGET_UPDATE 这个ACTION，如果有其他需求还可以添加自定义的ACTION， \<action android:name="com.linjiamin.UPDATE" \=""> 就是我定义的广播，用于更新这个AppWidget</action></li>
</ul>
<pre><code>&lt;receiver android:name=&quot;.widget.WidgetProvider&quot;&gt;
    &lt;intent-filter&gt;

        &lt;action android:name=&quot;android.appwidget.action.APPWIDGET_UPDATE&quot;/&gt;
        &lt;action android:name=&quot;com.linjiamin.UPDATE&quot;/&gt;
    &lt;/intent-filter&gt;
    &lt;meta-data
        android:name=&quot;android.appwidget.provider&quot;
        android:resource=&quot;@xml/app_widget&quot;/&gt;
&lt;/receiver&gt; 
</code></pre><h4 id="AppWidgetProviderInfo"><a href="#AppWidgetProviderInfo" class="headerlink" title="AppWidgetProviderInfo"></a>AppWidgetProviderInfo</h4><ul>
<li>meta-data中的resource属性指向的布局文件应该写在res的xml包下，如果没有这个包则新建即可，这个xml对应于AppWidgetProviderInfo类的类属性，包含了整个AppWidget的配置信息</li>
</ul>
<pre><code>&lt;!--in app_widget.xml--&gt;
&lt;appwidget-provider xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:initialLayout=&quot;@layout/app_widget&quot;
    android:minHeight=&quot;120dp&quot;
    android:minWidth=&quot;120dp&quot;
    android:previewImage=&quot;@mipmap/ic_launcher&quot;
    android:resizeMode=&quot;horizontal|vertical&quot;
    android:updatePeriodMillis=&quot;3000&quot;
    android:widgetCategory=&quot;home_screen|keyguard&quot;&gt;
&lt;/appwidget-provider&gt;
</code></pre><ul>
<li>AppWidgetProviderInfo 有如下几个属性可供配置</li>
</ul>
<pre><code>minWidth 和 minHeight：AppWidget最小的布局宽高，但不是确切的布局宽高，AppWidget的尺寸的最小单位为桌面每个网格的尺寸，如果不足整数个网格将向上取整，手机上不建议大于4*4个网格

minResizeWidth 和 minResizeHeight ，允许用户重新调整尺寸，minResizeWidth可以小于minWidth，但实际尺寸不能小于minResizeWidth，minResizeHeight同理

updatePeriodMillis ：widget的更新频率，即是更新的回调方法onUpdate粗略的调用频率，在1.6以后，频率不能高于30分钟一次，否则会被设定为30分钟一次，由于更新会唤醒设备所以会有一定的能耗，如果使用 alarm来替代该属性，alarm应设置为 ELAPSED_REALTIME 或 RTC，同时将 updatePeriodMillis 设为 0。

initialLayout : widget 的布局资源文件，只能包含特定的控件

configure：当 widget 创建时，会自动启动填写的Activity，这个Activity应用于进行配置信息

previewImage：预览图，如果没有提供则使用应用图标。

utoAdvanceViewId ：指定一个子view ID，表明该子 view 会自动更新

resizeMode ： horizontal, vertical, none，分别为可拉伸的方向

widgetCategory：home_screen，keyguard，指定widget是否在桌面和锁屏界面上显示

initialKeyguardLayout ： 锁屏界面的布局资源文件
</code></pre><h4 id="主布局"><a href="#主布局" class="headerlink" title="主布局"></a>主布局</h4><ul>
<li>布局，RemoteView只能支持一下几种布局，这个例子中只用到了TextView和ListView，和普通控件的布局没有差别</li>
</ul>
<pre><code>//可供使用的布局
Layout: FrameLayout,LinearLayout,RelativeLayout，GridLayout

View：AnalogClock，Button，Chronometer，ImageButton，ImageView，ProgressBar ，TextView，ViewFlipper，ListView，GridView，StackView，AdapterViewFilter，ViewStub

&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
android:layout_width=&quot;match_parent&quot;
android:layout_height=&quot;match_parent&quot;
android:gravity=&quot;center_horizontal&quot;
android:orientation=&quot;vertical&quot;&gt;

&lt;TextView
android:id=&quot;@+id/widget_tv&quot;
android:layout_width=&quot;wrap_content&quot;
android:layout_height=&quot;wrap_content&quot;
android:text=&quot;0&quot;
android:textSize=&quot;36sp&quot;
android:textStyle=&quot;bold&quot;/&gt;

&lt;ListView
android:id=&quot;@+id/widget_lv&quot;
android:layout_width=&quot;wrap_content&quot;
android:layout_height=&quot;wrap_content&quot;&gt;
&lt;/ListView&gt;
&lt;/LinearLayout&gt;
</code></pre><h4 id="AppWidgetProvider"><a href="#AppWidgetProvider" class="headerlink" title="AppWidgetProvider"></a>AppWidgetProvider</h4><ul>
<li>AppWidgetProvider，AppWidgetProvider的onReceive中会接收诸如 APPWIDGET_UPDATE，APPWIDGET_DELETED等ACTION，然后调用相应的生命周期方法，如果我们要接收自定义的广播，需要重写onReceive然后调用自己的方法</li>
</ul>
<ul>
<li>onReceive使用的几个回调方法为，onUpdate() ，RemoteView在需要更新数据时调用，onDeleted()，AppWidget被移除时调用  ，onEnabled，AppWidget被实例化时调用，重复实例化时不会反复调用该方法，onDisabled()，AppWidget的最后一个实例被delete时调用</li>
</ul>
<ul>
<li>由于XML中配置的更新频率不能大于30分钟一次，所以这里实现一个Service来更新，在onReceive中接受到自定义的ACTION，然后调用自定义的update方法，在onEnabled中启动发送广播的service，</li>
</ul>
<pre><code>public class WidgetProvider extends AppWidgetProvider {

public static int mIndex = 0;
@Override
public void onReceive(Context context, Intent intent) {
super.onReceive(context, intent);
if(intent.getAction().equals(UpdateService.ACTION_UPDATE)){
    Update(context);
    Log.d(TAG, &quot;onReceive: &quot;);
    }
}

@Override
public void onEnabled(Context context) {

Intent intent = new Intent(context, UpdateService.class);
context.startService(intent);
Log.d(TAG, &quot;onEnabled: &quot;);
super.onEnabled(context);
}

@Override
public void onAppWidgetOptionsChanged(Context context, AppWidgetManager appWidgetManager, int appWidgetId, Bundle
    newOptions) {
super.onAppWidgetOptionsChanged(context, appWidgetManager, appWidgetId, newOptions);
}

@Override
public void onRestored(Context context, int[] oldWidgetIds, int[] newWidgetIds) {
super.onRestored(context, oldWidgetIds, newWidgetIds);
}

@Override
public void onDeleted(Context context, int[] appWidgetIds) {
super.onDeleted(context, appWidgetIds);
}

@Override
public void onDisabled(Context context) {
Intent intent = new Intent(context,UpdateService.class);
context.stopService(intent);
super.onDisabled(context);
}
</code></pre><ul>
<li>更新RemoteView需要获取AppWidgetManager的实例并调用updateAppWidget方法传入包名或id和新的remoteViews</li>
</ul>
<pre><code>private void Update(Context context) {
    RemoteViews remoteViews = new RemoteViews(context.getPackageName(), R.layout.app_widget);
    remoteViews.setTextViewText(R.id.widget_tv, &quot;&quot;+mIndex);
    AppWidgetManager appWidgetManager = AppWidgetManager.getInstance(CurriculumApplication.getContext());
    appWidgetManager.updateAppWidget(new ComponentName(CurriculumApplication.getContext(), WidgetProvider.class), remoteViews);
mIndex ++;
    }
}
</code></pre><ul>
<li>发送广播的service这里用计时器来实现，这里每隔一秒发送一次广播，当然最好是使用AlarmManager的ELAPSED_REALTIME 或 RTC来实现，避免不必要地唤醒设备</li>
</ul>
<pre><code>public class UpdateService extends Service{

private Timer mTimer;
private TimerTask mTimerTask;
public static final int UPDATE_TIME = 1000;
public static final String ACTION_UPDATE = &quot;com.linjiamin.UPDATE&quot;;

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
return super.onStartCommand(intent, flags, startId);
}

@Nullable
@Override
public IBinder onBind(Intent intent) {
return null;
}

@Override
public void onCreate() {
super.onCreate();

Log.d(TAG, &quot;onCreate: &quot;);
mTimer = new Timer();
mTimerTask = new TimerTask() {
    @Override
    public void run() {
        Intent updateIntent = new Intent(ACTION_UPDATE);
        sendBroadcast(updateIntent);
    }
};
mTimer.schedule(mTimerTask, 1000, UPDATE_TIME);
    }

        @Override
    public void onDestroy() {
    super.onDestroy();
    mTimer.cancel();
    }
}
</code></pre><ul>
<li>现在来看回我们的AppWidgetProvider，还有一个很重要的方法没有讲解——onUpdate()，onUpdate()是系统每次决定更新时调用的方法，我们刚刚通过service实现的界面更新是不会调用到这个方法的，如果更新的频率不高于30分钟一次，那么在这个方法中实现更新的逻辑即可，注意对于ListView，StackView这些包含Item的复杂控件需要使用RemoteViewService获取Adapter，这些稍后再讲解</li>
</ul>
<ul>
<li>通常onUpdate()还会做两件事，设置点击事件和PendingIntent的模板，在这里我们为TextView设定了一个启动Activity的PendingIntent，跟Notification类似，没有什么好讲的，接着为ListView设置了适配器和PendingIntent的模板，为ListView的每一个Item设置PendingIntent是很浪费的，为了提高效率，必须在AppWidgetProvider中调用setPendingIntentTemplate，传入的PendingIntent作为模板，之后RemoteViewsFactory可以利用这个模板和新的Intent进行合成</li>
</ul>
<pre><code>@Override
public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) {

for(int id:appWidgetIds) {
    Log.d(TAG, &quot;onUpdate: &quot;);

    Intent updateIntent = new Intent(context, RemoteService.class);
    Intent openIntent = new Intent(context,CourseView.class);
    PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, openIntent, PendingIntent.FLAG_UPDATE_CURRENT);

    RemoteViews remoteViews = new RemoteViews(context.getPackageName(), R.layout.app_widget);
    remoteViews.setRemoteAdapter(R.id.widget_lv, updateIntent);
    remoteViews.setOnClickPendingIntent(R.id.widget_tv,pendingIntent);
    remoteViews.setPendingIntentTemplate(R.id.widget_lv,pendingIntent);
    appWidgetManager.updateAppWidget(id, remoteViews);
}
super.onUpdate(context, appWidgetManager, appWidgetIds);
}
</code></pre><h4 id="RemoteViewService-amp-amp-RemoteViewsFactory"><a href="#RemoteViewService-amp-amp-RemoteViewsFactory" class="headerlink" title="RemoteViewService &amp;&amp; RemoteViewsFactory"></a>RemoteViewService &amp;&amp; RemoteViewsFactory</h4><ul>
<li>RemoteViewService用于返回 RemoteViewsFactory，通常RemoteViewsFactory实现在RemoteViewService中即可</li>
</ul>
<ul>
<li>RemoteViewsFactory是ListView和StackView等子View的工厂，从这个角度来说它很像一种适配器，其中getViewAt方法相当于getView，但是需要返回的是一个RemoteView，其他方法可以参考ListView或RecycleView的适配器来写</li>
</ul>
<ul>
<li>可以看到这个例子中调用了RemoteView的setOnClickFillInIntent方法，传入一个新的Intent，由于这里没有什么特殊的需求，所以没有对这个intent进行额外的操作，这个Intent和刚刚的PendingIntent模板组合就能启动Activity了 ，另外如果要实现View的onClickListener的效果则需要使用PendingIntent.getBroadcast来设置模板，并且在getViewAt创建的Intent中传入具体的ACTION，后面就和刚刚的UpdateService是一个套路了</li>
</ul>
<pre><code>public class RemoteService extends RemoteViewsService {


private static final String TAG = &quot;RemoteService&quot;;


@Override
public void onCreate() {
super.onCreate();
Log.d(TAG, &quot;onCreate: &quot;);
}

@Override
public IBinder onBind(Intent intent) {
return super.onBind(intent);
}

@Override
public RemoteViewsFactory onGetViewFactory(Intent intent) {
return new RemoteFactory();
}

public class RemoteFactory implements RemoteViewsService.RemoteViewsFactory {

public List&lt;Integer&gt; mDataList = new ArrayList&lt;&gt;();


public RemoteFactory() {
    for (int i = 0; i &lt; 20; i++) {
        mDataList.add(i);
    }
    Log.d(TAG, &quot;onCreate: &quot;);
}

private static final String TAG = &quot;RemoteFactory&quot;;

@Override
public void onCreate() {

}

@Override
public void onDataSetChanged() {

}

@Override
public void onDestroy() {

}

@Override
public int getCount() {
    return mDataList.size();
}

@Override
public RemoteViews getViewAt(int position) {

    if (position &lt; 0 || position &gt; mDataList.size())
        return null;

    Intent intent = new Intent();
    RemoteViews remoteViews = new RemoteViews(CurriculumApplication.getContext().getPackageName(), R.layout.item_lv_course);
    remoteViews.setTextViewText(R.id.widget_tv_course, mDataList.get(position) + &quot;&quot;);
    remoteViews.setOnClickFillInIntent(R.id.item_lv_course,intent);

    return remoteViews;
}

@Override
public RemoteViews getLoadingView() {
    return null;
}

@Override
public int getViewTypeCount() {
    return 1;
}

@Override
public long getItemId(int position) {
    return position;
}

@Override
public boolean hasStableIds() {
    return true;
}

}
}
</code></pre><ul>
<li>最后注意非常重要的一点，既然RemoteViewService是Service，那么就必须注册，其中permission是一定要设置的，否则这个Service无法启动，这种情况下是不会有异常的，但是ListView等子控件将无法显示</li>
</ul>
<pre><code>&lt;service
    android:name=&quot;.widget.RemoteService&quot;
    android:permission=&quot;android.permission.BIND_REMOTEVIEWS&quot;
    android:enabled=&quot;true&quot;
    android:exported=&quot;true&quot; &gt;
&lt;/service&gt;
</code></pre><h3 id="RemoteViews"><a href="#RemoteViews" class="headerlink" title="RemoteViews"></a>RemoteViews</h3><ul>
<li>现在，我们来研究RemoteView是怎么更新的，我们知道需要更新RemoteViews中的控件时，由于我们获取不到需要的View，所以应该通过RemoteViews的方法来实现更新，比如下面的setImageViewBitmap方法对应的就是ImageView的setBitmap方法</li>
</ul>
<pre><code>remoteViews.setImageViewBitmap()    
</code></pre><ul>
<li>setImageViewBitmap调用setBitmap在第二个参数中传入了方法名，这个方法名是为了后面通过反射调用控件的方法而准备的，RemoteViews的Action表示我们想要对控件进行的操作，RemoteView会通过Binder传到Launcher的线程执行这些操作，从BitmapReflectionAction的名字很容易看出它使用了反射机制</li>
</ul>
<pre><code>public void setImageViewBitmap(int viewId, Bitmap bitmap) {
setBitmap(viewId, &quot;setImageBitmap&quot;, bitmap);
}

public void setBitmap(int viewId, String methodName, Bitmap value) {
addAction(new BitmapReflectionAction(viewId, methodName, value));
}
</code></pre><ul>
<li>接着来看RemoteViews的apply方法，这个方法通过LayoutInflater获取到了我们的AppWidget的布局，有了布局就可以进行更新操作了</li>
</ul>
<pre><code>public View apply(Context context, ViewGroup parent, OnClickHandler handler) {
RemoteViews rvToApply = getRemoteViewsToApply(context);

View result = inflateView(context, rvToApply, parent);
loadTransitionOverride(context, handler);

rvToApply.performApply(result, parent, handler);

return result;
}


private View inflateView(Context context, RemoteViews rv, ViewGroup parent) {
    LayoutInflater inflater = (LayoutInflater)

    ...
        context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

// Clone inflater so we load resources from correct context and
// we don&apos;t add a filter to the static version returned by getSystemService.
inflater = inflater.cloneInContext(inflationContext);
inflater.setFilter(this);
View v = inflater.inflate(rv.getLayoutId(), parent, false);
v.setTagInternal(R.id.widget_frame, rv.getLayoutId());
return v;
}
</code></pre><ul>
<li>performApply遍历了所有的Action，执行其apply方法，在ReflectionAction中apply方法使用findViewById得到需要更新的布局，findViewById返回的是一个View，这里我们并不知道需要更新的View的具体类型，由于之前传入了方法名所以这里通过反射获取到了需要使用的方法并直接调用，理论上也可以通过使用instanceOf关键字然后再用类型转换来实现，实际setRemoteAdapter的apply方法就是这么做的，但是如果对于所有的View都使用instanceOf，RemoteViews支持的View一共有十几种，相比之下还是使用反射会更加简洁易维护</li>
</ul>
<pre><code>private void performApply(View v, ViewGroup parent, OnClickHandler handler) {
if (mActions != null) {
    handler = handler == null ? DEFAULT_ON_CLICK_HANDLER : handler;
    final int count = mActions.size();
    for (int i = 0; i &lt; count; i++) {
        Action a = mActions.get(i);
        a.apply(v, parent, handler);
    }
}
}   

           @Override
public void apply(View root, ViewGroup rootParent, OnClickHandler handler) {
    final View view = root.findViewById(viewId);
    if (view == null) return;

    Class&lt;?&gt; param = getParameterType();
    if (param == null) {
        throw new ActionException(&quot;bad type: &quot; + this.type);
    }

    try {
        getMethod(view, this.methodName, param).invoke(view, wrapArg(this.value));
    } catch (ActionException e) {
        throw e;
    } catch (Exception ex) {
        throw new ActionException(ex);
    }
}
</code></pre><h3 id="AppWidget-与-binder"><a href="#AppWidget-与-binder" class="headerlink" title="AppWidget 与 binder"></a>AppWidget 与 binder</h3><ul>
<li>AppWidget是利用binder机制实现的，那么就来看看binder接口是怎么实现的，由于部分代码属于internal包，在Android Studio上可能无法查看，可以选择查看<a href="http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/5.1.1_r1/com/android/server/SystemService.java#SystemService.publishBinderService(java.lang.String,android.os.IBinder)" target="_blank" rel="external">这里</a>，如果有更方便的办法，请告诉我</li>
<li>这里先讲解一下Luncher 是什么，为此首先明确一点，Android系统上所谓的桌面本身也是一个应用，这个系统应用我们管他叫启动器或者Luncher，更准确地说Luncher其实是一个Activity，我们的桌面的主视图是一个继承自PagedView的Workspace，每一页就是一个CellLayout，看看下面这一段，是不是觉得很熟悉？</li>
</ul>
<pre><code>public final class Launcher extends Activity implements View.OnClickListener, OnLongClickListener 
</code></pre><ul>
<li>我们知道Activity默认运行在Application指定的进程中，Launcher的Manifest文件我就懒得翻源码了，有需要可以看<a href="http://quanminchaoren.iteye.com/blog/898647" target="_blank" rel="external">这里</a></li>
</ul>
<ul>
<li>刚刚提到 AppWidgetManager 是在SystemServer进程中的，那么加上我们的自己应用的进程和Launcher所在的进程RemoteView就需要在三个进程之间传递，在一个应用中更新另一个应用的Activity，是不是很刺激？</li>
</ul>
<ul>
<li>在需要更新AppWidget时，我们调用了AppWidgetManager.updateAppWidget方法，查看下列源码，调用到了mService的同名方法，而这个mService 的类型是<a href="\* [IAppWidgetService][3]">IAppWidgetService</a>，源码很长，我就不贴出来了，用过AIDL的应该会觉得很熟悉，和我们AS生成的 **AIDL.java的结构是一致的，mServie就是一个binder的代理（Proxy）类，调用它的方法会走Transaction过程，那么我们调用的方法最终就会在AppWidgetManager所在的进程中也就是SystemServer的进程中被调用了</li>
</ul>
<pre><code>public void updateAppWidget(int[] appWidgetIds, RemoteViews views) {
if (mService == null) {
    return;
}
try {
    mService.updateAppWidgetIds(mPackageName, appWidgetIds, views);
} catch (RemoteException e) {
    throw e.rethrowFromSystemServer();
}
}
</code></pre><ul>
<li>看完了Proxy，当然就轮到我们的Binder类了，Binder的实现类为AppWidgetServiceImpl，这里忽略一部分代码，这里主要是通过传入的id拿到了widget对象，widget对象是对每个appWidget的封装，结构很简单</li>
</ul>
<pre><code>private void updateAppWidgetIds(String callingPackage, int[] appWidgetIds,
    RemoteViews views, boolean partially) {
    ...
    synchronized (mLock) {
    ensureGroupStateLoadedLocked(userId);

    final int N = appWidgetIds.length;
    for (int i = 0; i &lt; N; i++) {
        final int appWidgetId = appWidgetIds[i];

        // NOTE: The lookup is enforcing security across users by making
        // sure the caller can only access widgets it hosts or provides.
        Widget widget = lookupWidgetLocked(appWidgetId,
                Binder.getCallingUid(), callingPackage);

        if (widget != null) {
            updateAppWidgetInstanceLocked(widget, views, partially);
        }
    }
}
}


    private static final class Widget {
int appWidgetId;
int restoredId;  // tracking &amp; remapping any restored state
Provider provider;
RemoteViews views;
Bundle options;
Host host;

@Override
public String toString() {
    return &quot;AppWidgetId{&quot; + appWidgetId + &apos;:&apos; + host + &apos;:&apos; + provider + &apos;}&apos;;
}
}
</code></pre><ul>
<li>找到 Widget之后会调用 updateAppWidgetInstanceLocked来进行更新,这里将Widget进行拆解之后使用Handler了回到了主线程</li>
</ul>
<pre><code>    private void updateAppWidgetInstanceLocked(Widget widget, RemoteViews views,
    boolean isPartialUpdate) {
if (widget != null &amp;&amp; widget.provider != null
        &amp;&amp; !widget.provider.zombie &amp;&amp; !widget.host.zombie) {

    if (isPartialUpdate &amp;&amp; widget.views != null) {
        // For a partial update, we merge the new RemoteViews with the old.
        widget.views.mergeRemoteViews(views);
    } else {
        // For a full update we replace the RemoteViews completely.
        widget.views = views;
    }

    scheduleNotifyUpdateAppWidgetLocked(widget, views);
}
}


    private void scheduleNotifyUpdateAppWidgetLocked(Widget widget, RemoteViews updateViews) {
if (widget == null || widget.provider == null || widget.provider.zombie
        || widget.host.callbacks == null || widget.host.zombie) {
    return;
}

SomeArgs args = SomeArgs.obtain();
args.arg1 = widget.host;
args.arg2 = widget.host.callbacks;
args.arg3 = updateViews;
args.argi1 = widget.appWidgetId;

mCallbackHandler.obtainMessage(
        CallbackHandler.MSG_NOTIFY_UPDATE_APP_WIDGET,
        args).sendToTarget();
}
</code></pre><ul>
<li>handleMessage中会调用到了handleNotifyUpdateAppWidget，这个callBack即是IAppWidgetHost，IAppWidgetHost又是一个Proxy类，这里我们就进入了另一个Binder机制了，这一个Binder用于与远程的Launcher进行通讯，同样地我们需要找到Binder的实现类</li>
</ul>
<pre><code>private void handleNotifyUpdateAppWidget(Host host, IAppWidgetHost callbacks,
    int appWidgetId, RemoteViews views) {
try {
    callbacks.updateAppWidget(appWidgetId, views);
} catch (RemoteException re) {
    synchronized (mLock) {
        Slog.e(TAG, &quot;Widget host dead: &quot; + host.id, re);
        host.callbacks = null;
    }
}
}
</code></pre><ul>
<li>Launcher这个Activity中含有LauncherAppWidgetHost对象这个类继承自AppWidgetHost，AppWidgetHost中含有Binder的实现类Callbacks</li>
</ul>
<pre><code>public final class Launcher extends Activity
implements View.OnClickListener, OnLongClickListener, LauncherModel.Callbacks,
           View.OnTouchListener {
           ...
private LauncherAppWidgetHost mAppWidgetHost;
</code></pre><ul>
<li>这里使用Handler回到主线程，接下来自然是Launcher这个Activity要更新界面了</li>
</ul>
<pre><code>static class Callbacks extends IAppWidgetHost.Stub {
private final WeakReference&lt;Handler&gt; mWeakHandler;

public Callbacks(Handler handler) {
    mWeakHandler = new WeakReference&lt;&gt;(handler);
}

public void updateAppWidget(int appWidgetId, RemoteViews views) {
    if (isLocalBinder() &amp;&amp; views != null) {
        views = views.clone();
    }
    Handler handler = mWeakHandler.get();
    if (handler == null) {
        return;
    }
    Message msg = handler.obtainMessage(HANDLE_UPDATE, appWidgetId, 0, views);
    msg.sendToTarget();
}
</code></pre><ul>
<li>updateAppWidgetView中的applyRemoteViews其实就是调用RemoteViews的Apply方法，也就是我们刚刚提到的根据反射去得到View的具体方法然后调用，这样我们的界面就在Launcher上面更新了</li>
</ul>
<pre><code>void updateAppWidgetView(int appWidgetId, RemoteViews views) {
AppWidgetHostView v;
synchronized (mViews) {
    v = mViews.get(appWidgetId);
}
if (v != null) {
    v.updateAppWidget(views);
}
}


public void updateAppWidget(RemoteViews remoteViews) {
applyRemoteViews(remoteViews);
}
</code></pre>
    

    
</div>


                

                <!-- Post Comments -->
                
                    
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/10/23/RxJava/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/09/06/BUG/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.jpg);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="Albert Humbert's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        709913148@qq.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/05/">五月 2018<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/04/">四月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/03/">三月 2018<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/12/">十二月 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/11/">十一月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">十月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/09/">九月 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/08/">八月 2017<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/07/">七月 2017<span class="sidebar_archives-count">24</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/05/">五月 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/04/">四月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">三月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/02/">二月 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/01/">一月 2017<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/12/">十二月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/11/">十一月 2016<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/10/">十月 2016<span class="sidebar_archives-count">3</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    

    <!-- Pages  -->
    
        <li>
            <a href="/about" title="关于我">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                关于我
            </a>
        </li>
        
    
        <li>
            <a href="/tags" title="标签索引">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                标签索引
            </a>
        </li>
        
    
        <li>
            <a href="/links" title="友情链接">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                友情链接
            </a>
        </li>
        
    
        <li>
            <a href="/whatever" title="Writers &amp; Weirdos">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                Writers &amp; Weirdos
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/twitter" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-twitter">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/facebook" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-facebook">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://www.google.com/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-gplus">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;2016&nbsp;-<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>Albert's Blog
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import File -->


    <script>lsloader.load("js/lazyload.min.js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==")</script>
    <script>lsloader.load("js/js.min.js","/js/js.min.js?oAl/+lvaqTFV31JXTmbrNA==")</script>



    <script>lsloader.load("js/nprogress.js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==")</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>













<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Window Load-->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->

<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Bing Background -->


<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.4.0 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
